\section{Limits on \mueee from Muon Decays}
In section \ref{sec:mu3e_experiment}, we saw how the production rate of $\mu^+$ at \mueee could be brought to the level of muon decays occuring at a rate $\order(10^9) \mu^+/s$.
The signal for the \mueee experiment, $\mu^+ \rightarrow e^+ e^+ e^-$, contains no missing energy as there are no neutrinos in the final state.
The SM has many avenues to produce such a signal with missing energy through muon decay, and we will go through the relevant backgrounds to our limits here.
Since the experiment is looking at a muon beam, it can be expected that there will be many events that behave like a muon decay and have missing energy.
Our signal will overlap with the backgrounds present and \mueee, and will allow us to study the signal component of $\mu^+ \rightarrow e^+ \bar{\nu}_\mu \nu_e e^+ e^-$.

For this experiment, we have utilized \madgraph to do the final state integration, as our signal will have four particles in the final state, and this is difficult to do by hand.
Furthermore, even though we will be looking at a four body decay, the scalar particle will be on-shell and decay later to an $e^+ e^-$ pair, and \madgraph will also take care of generating the events corresponding to this decay.
All of the diagrams that \madgraph generates are available in appendix \ref{app:muon_diagrams}.

\subsection{Backgrounds}
Here we will discuss the relevant backgrounds to the experiment and their initial implications on their effects on our limits.

A strong irreducible background for the experiment is

\begin{equation}
    \mu^+ \rightarrow e^+ + \bar{\nu}_\mu + \nu_e + e^+ + e^-
\end{equation}

\noindent which comes with a branching ratio of $3.4 \times 10^{-5}$ \cite{Agashe:2014kda}. 
This is due to an internal conversion of muon to electron with a weak vertex, just like an ordinary muon decay, also known as a Michel decay.
To remove this background process, momentum conservation can be applied provided that the energy resolution is small enough.
For \mueee, a total energy resolution of $\sigma_E < 1\textrm{MeV}$ is sufficient for sensitivity of branching ratios down to $10^{-15}$ \cite{Blondel:2013ia}.
One such diagram for this process is shown in Fig.\ \ref{fig:mu_eeenunu_SM}.

\begin{figure}[h]
    \centering
    \includegraphics[width = 0.6\textwidth]{Figures/feynman_diagrams/mu_eeenunu_SM.eps}
    \caption{One Feynman diagram for the process $\mu^+ \rightarrow e^+ \bar{\nu}_\mu \nu_e e^+ e^-$. Here a virtual photon is emitted and decays to an $e^+ e^-$ pair. Note that the photon can be radiated off of any of the charged particles in the diagram before the $e^+ e^-$ decay. This background process can be suppressed by using momentum conservation with a high energy resolution.}
    \label{fig:mu_eeenunu_SM}
\end{figure}


Another source of background for the experiment is the radiative muon decay

\begin{equation}
    \mu^+ \rightarrow e^+ + \bar{\nu}_\mu + \nu_e + \gamma
\end{equation}

\noindent where the $\gamma$ radiates off of either the muon or electron.
This process comes with a branching ratio of $1.4 \times 10^{-2}$, given a photon energy larger than $10\textrm{MeV}$ \cite{Agashe:2014kda}.
The photon can then convert to an $e^+ e^-$ pair in the detector or target material, and mimic the irreducible background above.
Conversions outside of the target can be supressed if the vertex can be readily identified.
Within the target, this background appears as an accidental background with a regular muon decay.

There are other sources of background present as well.
We've already briefly mentioned Michel decays, which can be identified by the lack of any negatively charged particle tracks, since the experiment uses a $\mu^+$ beam.
Bhabha scattering from the positrons coming from either the muon decay, or a contaminated beam, scattering off of the target material make an $e^+ e^-$ pair appear from a single vertex.
This has missing energy from the unaccounted electron in the target material, and can be removed as the irreducible background.
Finally, there are also pions that may contaminate the beam and decay either to $\pi^+ \rightarrow e^+ e^+ e^- \nu_e$, or $\pi^+ \rightarrow \mu^+ \nu_\mu \gamma$ with the photon converting to an $e^+ e^-$ pair, which have branching ratios $3.2 \times 10^{-9}$ and $2.00 \times 10^{-4}$ relatively \cite{Agashe:2014kda}.
It is expected that the pion contamination is on the order of $10^{-12}$ for the HiMB~\cite{Blondel:2013ia}, and the small decay rates should also suppress these numbers of events to safely negligible rates.

Using \madgraph, we generate $200,000$ events corresponding to the SM background for our signal, $\mu^+ \rightarrow e^+ \bar{\nu}_\mu \nu_e e^+ e^-$.
We use such a high amount to have properly populated bins near the tails of the distribution, where the likelihood that a bin will be populated is small.
To improve the time required to generate the events, we ignore contributions from the Higgs and the $Z$ bosons, as they will not contribute at energies associated with muon decay.
As a sanity check, the total width we obtain from the SM process is $1.239\times 10^{-23}\textrm{GeV}$, yielding a branching ratio of $4.119\times 10^{-5}$, which is sensible compared with the PDG value of $(3.4 \pm 0.4) \times 10^{-5}$ \cite{Agashe:2014kda}.

\subsection{Signal}
The signal we are interested in is the change in the irreducible background present in \mueee.
That is, the process we are investigating has the same final state as $\mu^+ \rightarrow e^+ \bar{\nu}_\mu \nu_e e^+ e^-$.

We will be using both the scalar model and the dark photon model here.
The signal processes of interest are the decay chains

\begin{align}
    \mu^+ & \rightarrow e^+ + \bar{\nu}_\mu + \nu_e + \phi,~\phi \rightarrow e^+ + e^- \\
    \mu^+ & \rightarrow e^+ + \bar{\nu}_\mu + \nu_e + A',~A' \rightarrow e^+ + e^-
\end{align}

\noindent with the $\phi$ and $A'$ being produced on-shell.
One diagram for the scalar case can be seen in Fig.\ \ref{fig:mu_eeenunu_scalar}.
All of the diagrams generated by \madgraph that are used can be seen in appendix \ref{app:muon_diagrams}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.6\textwidth]{Figures/feynman_diagrams/mu_eeenunu_scalar}
    \caption{Feynman diagram for scalar signal in muon decay. Note that the $\phi$ is produced on-shell before decaying to an $e^+ e^-$ pair promptly, as the width of the scalar is taken to be very small and $\textrm{BR}(\phi \rightarrow e^+ e^-) = 1$. There is a second diagram with the scalar being radiated off of the electron from the $W$ decay instead of off the incoming muon. Two identical diagrams exist for the dark photon, where the $A'$ replaces the $\phi$.}
    \label{fig:mu_eeenunu_scalar}
\end{figure}

We generate events at $10,000$ events at 200 different mass points, logarithmically spaced from $1.1\textrm{MeV}$, slightly higher than $2m_e$, up to $100\textrm{MeV}$, slightly lower than $m_\mu$.
It's worth briefly noting here that \madgraph does not natively support scanning over a parameter, such as the mass of the mediator.
To get around this, we have written a wrapper around \madgraph in \texttt{Python}, which will directly interface with the \madgraph calls and can automatically run the generator over any parameter scan, with minimal overhead.
For all runs, the coupling to the muon and scalar is set at $g_{\phi\mu} = 0.1$, and will be rescaled later to determine the limiting value.
$10,000$ events were chosen to be generated to reduce the statistical error in each bin, as we will be scaling the number of events up to $\sim 10^{16}$ total events.
This was also a sweet spot where the time taken to generate the events on a modern laptop was on the order of a few hours.
The results of generating these events are twofold:
\begin{itemize}
    \item{The total width of the process is given, which varies from $1.31\times 10^{-22} - 3.444\times 10^{-34}\textrm{GeV}$ for the choice of $g_{\phi\mu}$. Given the muon total width is $3.008 \times 10^{-19}\textrm{GeV}$~\cite{Agashe:2014kda}, this gives branching ratios $\order(10^{-4} - 10^{-15})$, a wide range of 11 orders of magnitude.}
    \item{A collection of events with the four-momentum for each particle, and their parent if they are a decay product. We can use these to draw the spectrum of the decay products.}
\end{itemize}

Once we have a collection of events, we can bin the results in a sensible parameter, and use the spectrum to place limits on the sensitivity of \mueee.
A natural choice here is to plot the histogram of events in the invariant mass of the $e^+ e^-$ pair.
Since the scalar is decaying on-shell and it has a narrow width, the invariant mass of its decay products must equal the mass of the parent.
This yeilds a resonant ``bump'' in the decay spectrum at the mass of the scalar, and the signal spectrum behaves as a delta function.
Since the final state has two positrons, it is not clear which to use when constructing the invariant mass spectrum.
These should be back to back, so some cuts could be decided on which would correspond to the correct pair with a high confidence.
However, for our simple analysis, we do the naive thing and construct both available pairs, and simply correct by a factor of two.
Note that while we know the true parent, we do not make use of this information to reflect better an experimental point of view of discovery.

The choice of binning chosen is very important.
Too wide and the signal features can be spread across a wide number of background events in the same bin.
On the other side, we are limited by the detector's tracking and energy resolution.
Through private communication in August, 2014 with Dr. Andre Sch\"oning, the contact person at \mueee, we have been told that the mass resolution is $\sigma_m / m \approx 0.004$.
This holds best for the heavier mediators, in the range of $10 - 100\textrm{MeV}$.
Lighter invariant mass pairs, $\sim 1\textrm{MeV}$, are harder to distinguish, as the decay angle is small and the resolution is limited by multiple scattering.
For now, we simply use the mass resolution at $10\textrm{MeV}$ as written down, for the low mass limit of our generated events, but one must keep in mind that below $10\textrm{MeV}$, the results will likely be overly optimistic.

With this mass resolution in mind, we go bin each of the spectra.
After scaling up the total number of events to $10^{15}~(5.5\times 10^{16})$ for \mueee phase I (phase II), scaling the signal events by the branching ratio of the signal, and scaling the background events by the SM branching ratio, we have a ready to use spectrum.
The scaling by the branching ratios ensures that we have the correct number of expected total signal events, and background events.
As an example spectrum, with both background and signal, we show Fig.\ \ref{fig:mu_eeenunu_spectrum}.

\begin{figure}[t]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/spectra/mu_eeenunu_scalar}
        \label{fig:mu_eeenunu_scalar_spectrum}
    \end{subfigure}
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/spectra/mu_eeenunu_scalar_background}
        \label{fig:mu_eeenunu_scalar_background_spectrum}
    \end{subfigure}
    \caption{Sample invariant mass spectrm from events generated by \madgraph. Events in red correspond to signal events, and events in blue correspond to background events.
            \textbf{Left}: The signal spectrum. Note the narrow resonance corresponding to the production of the scalar mediator. To see the peak well, $g_{\phi\mu} = 0.01$ is used.
            \textbf{Right}: The signal and background spectrum. The bump is slightly visible above the background, centered at the mass used during generation. Elsewhere on the spectrum, the signal is not visible.}
    \label{fig:mu_eeenunu_spectrum}
\end{figure}

Once we have a spectrum, it is easy to find the limiting coupling according to our prescription in section \ref{sec:limit_procedure} and equation \ref{eqn:gphi_limit}.
Instead of analyzing the total number of signal and background events, we can do better by using the spectrum and focusing on the region where the resonance occurs.
This reduces the background within the bin to a much more reasonable level for sensitivity, and also keeps all of the signal since we are in a very narrow width scenario.
To implement this, we ask for the bin with maximum signal, look up the corresponding background level, and compute $g_{\phi\mu}^\textrm{limit}$ to $3\sigma$.
The resulting limits are shown in Fig.\ \ref{fig:mu3e_limits}.

\begin{figure}[h]
    \centering
    \includegraphics[0.5\textwidth]{Figures/limits/mu3e}
    \caption{Limits on scalar coupling to muon using $\mu^+$ decay at \mueee. Results are interpolated using 200 mass points for the scalar. In blue are the phase I limits, and in red are the phase II limits.}
    \label{fig:mu3e_limits}
\end{figure}
